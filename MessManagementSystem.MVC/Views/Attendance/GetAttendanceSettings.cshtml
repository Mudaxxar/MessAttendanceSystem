@using MessManagementSystem.Shared.Models.ResponseModels;
@{
	Layout = "~/Views/Shared/_DreamLayout.cshtml";
}
<div class="page-wrapper">
	<div class="content">
		<div class="page-header">
			<div class="page-title">
				<h4>Time Management</h4>
				<h6>Add/Update Attendance Time</h6>
			</div>
		</div>
		<!-- /add -->
		<div class="card">
			<div class="card-body">
				<div class="row">

					<div class="col-lg-3 col-sm-6 col-12">
						<div class="mb-3">
							<label class="form-label">Start Time<span class="text-danger ms-1">*</span></label>
							<div class="input-groupicon">
								<input type="time" id="startTime" class="form-control" value="@Model.Data.StartTime" required>
							</div>
						</div>
					</div>

					<!-- End Time -->
					<div class="col-lg-3 col-sm-6 col-12">
						<div class="mb-3">
							<label class="form-label">End Time<span class="text-danger ms-1">*</span></label>
							<div class="input-groupicon">
								<input type="time" id="endTime" class="form-control" value="@Model.Data.EndTime" required>
							</div>
						</div>
					</div>

				</div>
			</div>
		</div>

		<div class="col-lg-12">
			<a class="btn btn-submit me-2" href="javascript:void(0);" id="submit" onclick="Save()">Submit</a>
		</div>
		<!-- /add -->
	</div>
</div>


@* <div class="modal fade" id="createSettings" aria-hidden="true" style="display: none;">
	<div class="modal-dialog modal-lg modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<div class="page-title">
					<h4>Create Attendances</h4>
				</div>
				<button type="button" class="close" data-bs-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">×</span>
				</button>
			</div>
			<div class="modal-body">
				<div class="row">
					<div class="col-lg-6">
						<div class="mb-3">
							<label class="form-label">Start Time<span class="text-danger ms-1">*</span></label>
							<div class="input-groupicon">
								<input type="time" id="startTime" class="form-control" required>
							</div>
						</div>
					</div>
					<div class="col-lg-6 col-sm-12 col-12">
						<div class="mb-3">
							<label class="form-label">End Time<span class="text-danger ms-1">*</span></label>
							<div class="input-groupicon">
								<input type="time" id="endTime" class="form-control" required>
							</div>
						</div>
					</div>

					<input type="hidden" id="id" name="UserId" />
				</div>

			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary me-2" data-bs-dismiss="modal">Cancel</button>
				<button type="submit" class="btn btn-primary" onclick="MarkAttendance()">Submit</button>
			</div>
		</div>
	</div>
</div> *@

<script>
	function Save() {

		var isValid = true;
		var startTime = $('#startTime').val();
		var endTime = $('#endTime').val();
		if (startTime == "" || startTime == null) {
			toastr.error("Start Time is missing!");
			isValid = false;
		}
		if (endTime == "" || endTime == null) {
			toastr.error("End Time is missing!");
			isValid = false;
		}
		
		// Add ":00" if needed to match TimeSpan format (HH:mm:ss)
		if (startTime && startTime.length === 5) {
			startTime += ':00';
		}

		if (endTime && endTime.length === 5) {
			endTime += ':00';
		}
		if (isValid) {
			var data = {
				StartTime: startTime,
				EndTime: endTime
			};
			$.ajax({
				url: '@Url.Action("AddSettings", "Attendance")',
				type: "POST",
				data: data,
				success: function (result, status) {
					if (status == "success") {
						if (result.isError === false) {
							toastr.success(result.description);
							window.location.reload();

						}
						else {
							if (result.isError === true) {
								toastr.error(result.description);
							} else {
								toastr.error(result.description);
							}

						}
						Clear();
					}
				},
				error: function (result) {
					toastr.error(result.description);
				},
			});
		}
	}

	function Clear() {
		$("#name").val('');
	}
</script>
